stop slave;
drop table if exists t1,t2,t3,t4,t5,t6,t7,t8,t9;
reset master;
reset slave;
drop table if exists t1,t2,t3,t4,t5,t6,t7,t8,t9;
start slave;
create table t1 (
a int not null primary key,
b text not null
) engine=ndb;
insert into t1 values(1, repeat('abc',10));
insert into t1 values(2, repeat('def',200));
insert into t1 values(3, repeat('ghi',3000));
select 'M', a, sha1(b) from t1
order by a;
M	a	sha1(b)
M	1	8a6c4cf7cf97e66c487c3e3b717e9ae13623d07d
M	2	0ccd08c0fa6ad6a4382b27b1d36586d6ceb4fffa
M	3	75e7b3299e0b776aeac2a4d1542d5b3c0ba2e05e
select 'S', a, sha1(b) from t1
order by a;
S	a	sha1(b)
S	1	8a6c4cf7cf97e66c487c3e3b717e9ae13623d07d
S	2	0ccd08c0fa6ad6a4382b27b1d36586d6ceb4fffa
S	3	75e7b3299e0b776aeac2a4d1542d5b3c0ba2e05e
drop table t1;
create table t1 (
a int not null primary key,
b text not null,
c int,
d longblob,
e tinyblob
) engine=ndbcluster;
insert into t1 values (
0, repeat(@s2,454), 100, repeat(@s2,345), NULL);
insert into t1 values (
1, repeat(@s0,504), NULL, repeat(@s1,732), repeat(@s1,1));
insert into t1 values (
2, '', 102, '', repeat(@s2,1));
insert into t1 values (
3, repeat(@s0,545), 103, repeat(@s2,788), repeat(@s0,1));
insert into t1 values (
4, repeat(@s1,38), 104, repeat(@s0,260), repeat(@s0,1));
insert into t1 values (
5, repeat(@s2,12), 105, repeat(@s2,40), repeat(@s1,1));
insert into t1 values (
6, repeat(@s1,242), 106, NULL, repeat(@s1,1));
insert into t1 values (
7, repeat(@s1,30), 107, repeat(@s0,161), '');
insert into t1 values (
8, repeat(@s1,719), 108, repeat(@s2,104), NULL);
insert into t1 values (
9, repeat(@s2,427), NULL, NULL, NULL);
select 'M', a, sha1(b), c, sha1(d), sha1(e)
from t1 order by a;
M	a	sha1(b)	c	sha1(d)	sha1(e)
M	0	9538f61e649383c0d1054de2a2f0171188129f33	100	2b6515f29c20b8e9e17cc597527e516c0de8d612	NULL
M	1	dcb9a12ca86e718ff2564be041b7c1b3ff5ea559	NULL	f23e7439d9a73c3954979b85a7ef6ef35faf4e9d	abfe8ae5212b22d023aa6de84beeb1344ac5668a
M	2	da39a3ee5e6b4b0d3255bfef95601890afd80709	102	da39a3ee5e6b4b0d3255bfef95601890afd80709	33deebe47470a40e960834bffa4cdc66790845a6
M	3	ec8e06d9ac4695d6a898b519ba840590263a9bff	103	278629ad080c3c4377978c006c2e54d0992e43cc	700915801f853603510aeb67b331866d996fdbda
M	4	0392fa8c425d293c79291f0f34779d1101d13fcb	104	5084b602c7203e0e9590a163415ac605da17ac32	700915801f853603510aeb67b331866d996fdbda
M	5	0f9653f0c7a69cd1c617792d546582e974a7a24d	105	566588a04ff26d05160d61c83435292bfda2978e	abfe8ae5212b22d023aa6de84beeb1344ac5668a
M	6	a37e8b0ff4fc13a42be02cdecb36186436959bae	106	NULL	abfe8ae5212b22d023aa6de84beeb1344ac5668a
M	7	a6bae0cfe6b45ff8c3c12d2ce577a1cd3931190f	107	39ee712b4b9e47f2cf3ba7c9790b2bf0d8f378e8	da39a3ee5e6b4b0d3255bfef95601890afd80709
M	8	e139adcb7b2974ee7ff227fd405709e5cb7c896c	108	ba8073b0e1a281d4111bd2d82c7722b01574c00b	NULL
M	9	1fc5168fe4be566b17b658d94e7813f0b5032cdb	NULL	NULL	NULL
select 'S', a, sha1(b), c, sha1(d), sha1(e)
from t1 order by a;
S	a	sha1(b)	c	sha1(d)	sha1(e)
S	0	9538f61e649383c0d1054de2a2f0171188129f33	100	2b6515f29c20b8e9e17cc597527e516c0de8d612	NULL
S	1	dcb9a12ca86e718ff2564be041b7c1b3ff5ea559	NULL	f23e7439d9a73c3954979b85a7ef6ef35faf4e9d	abfe8ae5212b22d023aa6de84beeb1344ac5668a
S	2	da39a3ee5e6b4b0d3255bfef95601890afd80709	102	da39a3ee5e6b4b0d3255bfef95601890afd80709	33deebe47470a40e960834bffa4cdc66790845a6
S	3	ec8e06d9ac4695d6a898b519ba840590263a9bff	103	278629ad080c3c4377978c006c2e54d0992e43cc	700915801f853603510aeb67b331866d996fdbda
S	4	0392fa8c425d293c79291f0f34779d1101d13fcb	104	5084b602c7203e0e9590a163415ac605da17ac32	700915801f853603510aeb67b331866d996fdbda
S	5	0f9653f0c7a69cd1c617792d546582e974a7a24d	105	566588a04ff26d05160d61c83435292bfda2978e	abfe8ae5212b22d023aa6de84beeb1344ac5668a
S	6	a37e8b0ff4fc13a42be02cdecb36186436959bae	106	NULL	abfe8ae5212b22d023aa6de84beeb1344ac5668a
S	7	a6bae0cfe6b45ff8c3c12d2ce577a1cd3931190f	107	39ee712b4b9e47f2cf3ba7c9790b2bf0d8f378e8	da39a3ee5e6b4b0d3255bfef95601890afd80709
S	8	e139adcb7b2974ee7ff227fd405709e5cb7c896c	108	ba8073b0e1a281d4111bd2d82c7722b01574c00b	NULL
S	9	1fc5168fe4be566b17b658d94e7813f0b5032cdb	NULL	NULL	NULL
drop table t1;
show binlog events;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
master-bin.000001	4	Format_desc	1	102	Server ver: VERSION, Binlog ver: 4
master-bin.000001	102	Query	1	239	use `test`; create table t1 (
a int not null primary key,
b text not null
) engine=ndb
master-bin.000001	239	Query	1	303	BEGIN
master-bin.000001	303	Table_map	1	53	cluster.apply_status
master-bin.000001	356	Write_rows	1	95	
master-bin.000001	398	Table_map	1	135	test.t1
master-bin.000001	438	Write_rows	1	806	
master-bin.000001	1109	Write_rows	1	9841	
master-bin.000001	10144	Query	1	10209	COMMIT
master-bin.000001	10209	Query	1	10273	BEGIN
master-bin.000001	10273	Table_map	1	53	cluster.apply_status
master-bin.000001	10326	Write_rows	1	95	
master-bin.000001	10368	Query	1	10433	COMMIT
master-bin.000001	10433	Query	1	10509	use `test`; drop table t1
master-bin.000001	10509	Query	1	10684	use `test`; create table t1 (
a int not null primary key,
b text not null,
c int,
d longblob,
e tinyblob
) engine=ndbcluster
master-bin.000001	10684	Query	1	10748	BEGIN
master-bin.000001	10748	Table_map	1	53	cluster.apply_status
master-bin.000001	10801	Write_rows	1	95	
master-bin.000001	10843	Table_map	1	138	test.t1
master-bin.000001	10886	Write_rows	1	48922	
master-bin.000001	59670	Write_rows	1	124424	
master-bin.000001	135172	Write_rows	1	124530	
master-bin.000001	135278	Write_rows	1	205949	
master-bin.000001	216697	Write_rows	1	224233	
master-bin.000001	234981	Write_rows	1	227511	
master-bin.000001	238259	Write_rows	1	242379	
master-bin.000001	253127	Write_rows	1	254075	
master-bin.000001	264823	Write_rows	1	304323	
master-bin.000001	315071	Write_rows	1	330415	
master-bin.000001	341163	Query	1	341228	COMMIT
master-bin.000001	341228	Query	1	341292	BEGIN
master-bin.000001	341292	Table_map	1	53	cluster.apply_status
master-bin.000001	341345	Write_rows	1	95	
master-bin.000001	341387	Query	1	341452	COMMIT
master-bin.000001	341452	Query	1	341528	use `test`; drop table t1
