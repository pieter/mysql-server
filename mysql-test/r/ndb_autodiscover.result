drop table if exists t1,t2,t3,t4,t5,t6,t9;
flush status;
create table t1(
id int not null primary key,
name char(20)
) engine=ndb;
insert into t1 values(1, "Autodiscover");
flush tables;
select * from t1;
id	name
1	Autodiscover
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	1
flush tables;
insert into t1 values (2, "Auto 2");
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	2
insert into t1 values (3, "Discover 3");
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	2
flush tables;
select * from t1;
id	name
2	Auto 2
3	Discover 3
1	Autodiscover
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	3
flush tables;
update t1 set name="Autodiscover" where id = 2;
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	4
select * from t1 order by name;
id	name
2	Autodiscover
1	Autodiscover
3	Discover 3
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	4
flush tables;
delete from  t1 where id = 3;
select * from t1;
id	name
2	Autodiscover
1	Autodiscover
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	5
drop table t1;
flush status;
create table t2(
id int not null primary key,
name char(22)
) engine=ndb;
insert into t2 values (1, "Discoverer");
select * from t2;
id	name
1	Discoverer
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	0
flush tables;
select * from t2;
id	name
1	Discoverer
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	1
drop table t2;
flush status;
create table t3(
id int not null primary key,
name char(255)
) engine=ndb;
insert into t3 values (1, "Explorer");
select * from t3;
id	name
1	Explorer
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	0
flush tables;
create table t3(
id int not null primary key,
name char(20), a int, b float, c char(24)
) engine=ndb;
ERROR 42S01: Table 't3' already exists
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	1
SHOW TABLES FROM test;
Tables_in_test
create table IF NOT EXISTS t3(
id int not null primary key,
id2 int not null,
name char(20)
) engine=ndb;
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	2
SHOW CREATE TABLE t3;
Table	Create Table
t3	CREATE TABLE `t3` (
  `id` int(11) NOT NULL default '0',
  `name` char(255) default NULL,
  PRIMARY KEY  (`id`)
) ENGINE=ndbcluster DEFAULT CHARSET=latin1
select * from t3;
id	name
1	Explorer
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	2
drop table t3;
flush status;
create table t4(
id int not null primary key,
name char(27)
) engine=ndb;
insert into t4 values (1, "Automatic");
select * from t4;
id	name
1	Automatic
select * from t4;
ERROR HY000: Got error 284 'Table not defined in transaction coordinator' from NDBCLUSTER
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	0
drop table t4;
flush tables;
show tables;
Tables_in_test
select * from t4;
ERROR 42S02: Table 'test.t4' doesn't exist
flush status;
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	0
create table t5(
id int not null primary key,
name char(200)
) engine=ndb;
insert into t5 values (1, "Magnus");
select * from t5;
id	name
1	Magnus
ALTER TABLE t5 ADD COLUMN adress char(255) FIRST;
select * from t5;
adress	id	name
NULL	1	Magnus
flush table t5;
select * from t5;
adress	id	name
NULL	1	Magnus
insert into t5 values 
("Adress for record 2", 2, "Carl-Gustav"), 
("Adress for record 3", 3, "Karl-Emil");
update t5 set name="Bertil" where id = 2;
select * from t5 order by id;
adress	id	name
NULL	1	Magnus
Adress for record 2	2	Bertil
Adress for record 3	3	Karl-Emil
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	0
drop table t5;
flush status;
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	0
create table t6(
id int not null primary key,
name char(20)
) engine=ndb;
insert into t6 values (1, "Magnus");
select * from t6;
id	name
1	Magnus
ALTER TABLE t6 ADD COLUMN adress char(255) FIRST;
select * from t6;
adress	id	name
NULL	1	Magnus
flush table t6;
select * from t6;
adress	id	name
NULL	1	Magnus
insert into t6 values 
("Adress for record 2", 2, "Carl-Gustav"), 
("Adress for record 3", 3, "Karl-Emil");
update t6 set name="Bertil" where id = 2;
select * from t6 order by id;
adress	id	name
NULL	1	Magnus
Adress for record 2	2	Bertil
Adress for record 3	3	Karl-Emil
show status like 'handler_discover%';
Variable_name	Value
Handler_discover	0
drop table t6;
CREATE TABLE t9 (
a int NOT NULL PRIMARY KEY,
b int
) engine=ndb;
insert t9 values(1, 2), (2,3), (3, 4), (4, 5);
