SET @@storage_engine = Falcon;
*** Bug #23816 ***
DROP TABLE IF EXISTS t1;
# Establish connection conn1 (user = root)
SET @@storage_engine = Falcon;
SET @@autocommit = 0;
# Switch to connection default
SET @@autocommit = 0;
CREATE TABLE t1 (a int, key i (a));
INSERT INTO t1 VALUES (1), (2), (3), (4), (5);
COMMIT;
START TRANSACTION;
INSERT INTO t1 VALUES (6);
# Switch to connection conn1
START TRANSACTION;
DROP INDEX i ON t1;
# Switch to connection default
SELECT count(*) FROM t1;
count(*)
6
COMMIT;
# Switch to connection conn1
ERROR HY000: Can't lock file (errno: 212)
COMMIT;
# Switch to connection default
SELECT count(*) FROM t1;
count(*)
6
COMMIT;
DROP TABLE t1;
