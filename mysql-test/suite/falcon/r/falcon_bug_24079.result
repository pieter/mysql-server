SET SESSION STORAGE_ENGINE = Falcon;
drop table if exists t1,t2,t3;
CREATE TABLE t1 (a int, b int);
insert into t1 values (1,2);
CREATE TEMPORARY TABLE t3 ( f1 CHAR(10));
SELECT * FROM t3;
f1
DROP TABLE t3;
CREATE TABLE t2 (a int, b int, primary key (a));
SELECT * FROM t2;
a	b
BEGIN;
INSERT INTO t2 values(100,100);
SELECT * FROM t2;
a	b
100	100
INSERT INTO t2 select 1,1 UNION ALL SELECT 1,1;
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
SELECT * from t2;
a	b
100	100
ROLLBACK;
DROP TABLE t1;
DROP TABLE t2;
CREATE TABLE t1 (a int, b int);
CREATE TEMPORARY TABLE t3 ( f1 CHAR(10));
SELECT * FROM t3;
f1
DROP TABLE t3;
SELECT * FROM t3;
ERROR 42S02: Table 'test.t3' doesn't exist
CREATE TABLE t2 (a int, b int, primary key (a));
SELECT * FROM t2;
a	b
BEGIN;
INSERT INTO t2 values(100,100);
SELECT * FROM t2;
a	b
100	100
INSERT INTO t2 select 1,1 UNION ALL SELECT 1,1;
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
SELECT * from t2;
a	b
100	100
ROLLBACK;
DROP TABLE t1;
DROP TABLE t2;
CREATE TEMPORARY TABLE t3 ( f1 CHAR(10));
SELECT * FROM t3;
f1
DROP TABLE t3;
SELECT * FROM t3;
ERROR 42S02: Table 'test.t3' doesn't exist
CREATE TABLE t2 (a int, b int, primary key (a));
SELECT * FROM t2;
a	b
BEGIN;
INSERT INTO t2 values(100,100);
SELECT * FROM t2;
a	b
100	100
INSERT INTO t2 select 1,1 UNION ALL SELECT 1,1;
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
SELECT * from t2;
a	b
100	100
ROLLBACK;
DROP TABLE t2;
CREATE TABLE t1 (a int, b int);
insert into t1 values (1,2);
CREATE TABLE t3 ( f1 CHAR(10));
SELECT * FROM t3;
f1
DROP TABLE t3;
SELECT * FROM t3;
ERROR 42S02: Table 'test.t3' doesn't exist
CREATE TABLE t2 (a int, b int, primary key (a));
SELECT * FROM t2;
a	b
BEGIN;
INSERT INTO t2 values(100,100);
SELECT * FROM t2;
a	b
100	100
INSERT INTO t2 select 1,1 UNION ALL SELECT 1,1;
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
SELECT * from t2;
a	b
100	100
ROLLBACK;
DROP TABLE t1;
DROP TABLE t2;
CREATE TABLE t1 (a int, b int);
insert into t1 values (1,2);
CREATE TEMPORARY TABLE t3 ( f1 CHAR(10));
DROP TABLE t3;
SELECT * FROM t3;
ERROR 42S02: Table 'test.t3' doesn't exist
CREATE TABLE t2 (a int, b int, primary key (a));
SELECT * FROM t2;
a	b
BEGIN;
INSERT INTO t2 values(100,100);
SELECT * FROM t2;
a	b
100	100
INSERT INTO t2 select 1,1 UNION ALL SELECT 1,1;
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
SELECT * from t2;
a	b
100	100
ROLLBACK;
DROP TABLE t1;
DROP TABLE t2;
CREATE TABLE t1 (a int, b int);
insert into t1 values (1,2);
CREATE TEMPORARY TABLE t3 ( f1 CHAR(10));
SELECT * FROM t3;
f1
DROP TABLE t3;
SELECT * FROM t3;
ERROR 42S02: Table 'test.t3' doesn't exist
CREATE TABLE t2 (a int, b int, primary key (a));
SELECT * FROM t2;
a	b
INSERT INTO t2 values(100,100);
SELECT * FROM t2;
a	b
100	100
INSERT INTO t2 select 1,1 UNION ALL SELECT 1,1;
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
SELECT * from t2;
a	b
100	100
ROLLBACK;
DROP TABLE t1;
DROP TABLE t2;
