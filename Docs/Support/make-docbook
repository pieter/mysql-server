#!/bin/sh
# 2002-01-30 arjen@mysql.com
# Use this to create mysql.xml (the DocBook XML format output of manual.texi)
# Requires makeinfo 4.0c

#create include.texi with version/port #
        echo "@c This file is autogenerated by the Makefile" > include.texi
        echo -n "@set mysql_version " >> include.texi
        grep "AM_INIT_AUTOMAKE(mysql, " ../configure.in | \
         sed -e 's;AM_INIT_AUTOMAKE(mysql, ;;' -e 's;);;' >> include.texi
        echo -n "@set default_port " >> include.texi
        grep "MYSQL_TCP_PORT_DEFAULT=" ../configure.in | \
         sed -e 's;MYSQL_TCP_PORT_DEFAULT=;;' >> include.texi

# produce DocBook XML
        makeinfo --force --no-ifinfo --docbook -o - manual.texi |\
         Support/docbook-fixup.pl > mysql.xml
    
        # See if the XML output is well-formed
        xmlwf mysql.xml
