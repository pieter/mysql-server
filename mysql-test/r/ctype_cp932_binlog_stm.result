drop table if exists t1;
set names cp932;
set character_set_database = cp932;
RESET MASTER;
CREATE TABLE t1(f1 blob);
PREPARE stmt1 FROM 'INSERT INTO t1 VALUES(?)';
SET @var1= x'8300';
EXECUTE stmt1 USING @var1;
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
master-bin.000001	#	Query	#	#	use `test`; CREATE TABLE t1(f1 blob)
master-bin.000001	#	Query	#	#	use `test`; INSERT INTO t1 VALUES('ƒ\0')
SELECT HEX(f1) FROM t1;
HEX(f1)
8300
DROP table t1;
CREATE TABLE t4 (s1 CHAR(50) CHARACTER SET latin1,
s2 CHAR(50) CHARACTER SET cp932,
d DECIMAL(10,2))|
CREATE PROCEDURE bug18293 (IN ins1 CHAR(50),
IN ins2 CHAR(50) CHARACTER SET cp932,
IN ind DECIMAL(10,2))
BEGIN
INSERT INTO t4 VALUES (ins1, ins2, ind);
END|
CALL bug18293("Foo's a Bar", _cp932 0xED40ED41ED42, 47.93)|
SELECT HEX(s1),HEX(s2),d FROM t4|
HEX(s1)	HEX(s2)	d
466F6F2773206120426172	ED40ED41ED42	47.93
DROP PROCEDURE bug18293|
DROP TABLE t4|
SHOW BINLOG EVENTS FROM 370|
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
master-bin.000001	370	Query	1	536	use `test`; CREATE TABLE t4 (s1 CHAR(50) CHARACTER SET latin1,
s2 CHAR(50) CHARACTER SET cp932,
d DECIMAL(10,2))
master-bin.000001	536	Query	1	784	use `test`; CREATE DEFINER=`root`@`localhost` PROCEDURE bug18293 (IN ins1 CHAR(50),
IN ins2 CHAR(50) CHARACTER SET cp932,
IN ind DECIMAL(10,2))
BEGIN
INSERT INTO t4 VALUES (ins1, ins2, ind);
END
master-bin.000001	784	Query	1	992	use `test`; INSERT INTO t4 VALUES ( NAME_CONST('ins1',_latin1 0x466F6F2773206120426172),  NAME_CONST('ins2',_cp932 0xED40ED41ED42),  NAME_CONST('ind',47.93))
master-bin.000001	992	Query	1	1081	use `test`; DROP PROCEDURE bug18293
master-bin.000001	1081	Query	1	1160	use `test`; DROP TABLE t4
End of 5.0 tests
SHOW BINLOG EVENTS FROM 365;
ERROR HY000: Error when executing command SHOW BINLOG EVENTS: Wrong offset or I/O error
set names cp932;
select @@collation_connection;
@@collation_connection
cp932_japanese_ci
select hex(weight_string('a'));
hex(weight_string('a'))
41
select hex(weight_string('A'));
hex(weight_string('A'))
41
select hex(weight_string('abc'));
hex(weight_string('abc'))
414243
select hex(weight_string('abc' as char(2)));
hex(weight_string('abc' as char(2)))
4142
select hex(weight_string('abc' as char(3)));
hex(weight_string('abc' as char(3)))
414243
select hex(weight_string('abc' as char(5)));
hex(weight_string('abc' as char(5)))
4142432020
select @@collation_connection;
@@collation_connection
cp932_japanese_ci
select hex(weight_string('a' LEVEL 1));
hex(weight_string('a' LEVEL 1))
41
select hex(weight_string('A' LEVEL 1));
hex(weight_string('A' LEVEL 1))
41
select hex(weight_string('abc' LEVEL 1));
hex(weight_string('abc' LEVEL 1))
414243
select hex(weight_string('abc' as char(2) LEVEL 1));
hex(weight_string('abc' as char(2) LEVEL 1))
4142
select hex(weight_string('abc' as char(3) LEVEL 1));
hex(weight_string('abc' as char(3) LEVEL 1))
414243
select hex(weight_string('abc' as char(5) LEVEL 1));
hex(weight_string('abc' as char(5) LEVEL 1))
4142432020
select hex(weight_string('abc' as char(5) LEVEL 1 REVERSE));
hex(weight_string('abc' as char(5) LEVEL 1 REVERSE))
2020434241
select hex(weight_string('abc' as char(5) LEVEL 1 DESC));
hex(weight_string('abc' as char(5) LEVEL 1 DESC))
BEBDBCDFDF
select hex(weight_string('abc' as char(5) LEVEL 1 DESC REVERSE));
hex(weight_string('abc' as char(5) LEVEL 1 DESC REVERSE))
DFDFBCBDBE
select collation(cast(0x8140 as char));
collation(cast(0x8140 as char))
cp932_japanese_ci
select hex(weight_string(cast(0x6141 as char)));
hex(weight_string(cast(0x6141 as char)))
4141
select hex(weight_string(cast(0x8140 as char)));
hex(weight_string(cast(0x8140 as char)))
8140
select hex(weight_string(cast(0x8140 as char) as char(1)));
hex(weight_string(cast(0x8140 as char) as char(1)))
8140
select hex(weight_string(cast(0x81408140 as char) as char(1)));
hex(weight_string(cast(0x81408140 as char) as char(1)))
8140
select hex(weight_string(cast(0x8140 as char) as char(3)));
hex(weight_string(cast(0x8140 as char) as char(3)))
81402020
select hex(weight_string(cast(0x81408140 as char) as char(3)));
hex(weight_string(cast(0x81408140 as char) as char(3)))
8140814020
select hex(weight_string(cast(0x408140 as char) as char(3)));
hex(weight_string(cast(0x408140 as char) as char(3)))
40814020
select hex(weight_string(cast(0x4081408140 as char) as char(3)));
hex(weight_string(cast(0x4081408140 as char) as char(3)))
4081408140
select hex(weight_string(cast(0x40814081408140 as char) as char(3)));
hex(weight_string(cast(0x40814081408140 as char) as char(3)))
4081408140
select hex(weight_string(cast(0x4040814081408140 as char) as char(3)));
hex(weight_string(cast(0x4040814081408140 as char) as char(3)))
40408140
set collation_connection=cp932_bin;
select @@collation_connection;
@@collation_connection
cp932_bin
select hex(weight_string('a'));
hex(weight_string('a'))
61
select hex(weight_string('A'));
hex(weight_string('A'))
41
select hex(weight_string('abc'));
hex(weight_string('abc'))
616263
select hex(weight_string('abc' as char(2)));
hex(weight_string('abc' as char(2)))
6162
select hex(weight_string('abc' as char(3)));
hex(weight_string('abc' as char(3)))
616263
select hex(weight_string('abc' as char(5)));
hex(weight_string('abc' as char(5)))
6162632020
select @@collation_connection;
@@collation_connection
cp932_bin
select hex(weight_string('a' LEVEL 1));
hex(weight_string('a' LEVEL 1))
61
select hex(weight_string('A' LEVEL 1));
hex(weight_string('A' LEVEL 1))
41
select hex(weight_string('abc' LEVEL 1));
hex(weight_string('abc' LEVEL 1))
616263
select hex(weight_string('abc' as char(2) LEVEL 1));
hex(weight_string('abc' as char(2) LEVEL 1))
6162
select hex(weight_string('abc' as char(3) LEVEL 1));
hex(weight_string('abc' as char(3) LEVEL 1))
616263
select hex(weight_string('abc' as char(5) LEVEL 1));
hex(weight_string('abc' as char(5) LEVEL 1))
6162632020
select hex(weight_string('abc' as char(5) LEVEL 1 REVERSE));
hex(weight_string('abc' as char(5) LEVEL 1 REVERSE))
2020636261
select hex(weight_string('abc' as char(5) LEVEL 1 DESC));
hex(weight_string('abc' as char(5) LEVEL 1 DESC))
9E9D9CDFDF
select hex(weight_string('abc' as char(5) LEVEL 1 DESC REVERSE));
hex(weight_string('abc' as char(5) LEVEL 1 DESC REVERSE))
DFDF9C9D9E
select collation(cast(0x8140 as char));
collation(cast(0x8140 as char))
cp932_bin
select hex(weight_string(cast(0x6141 as char)));
hex(weight_string(cast(0x6141 as char)))
6141
select hex(weight_string(cast(0x8140 as char)));
hex(weight_string(cast(0x8140 as char)))
8140
select hex(weight_string(cast(0x8140 as char) as char(1)));
hex(weight_string(cast(0x8140 as char) as char(1)))
8140
select hex(weight_string(cast(0x81408140 as char) as char(1)));
hex(weight_string(cast(0x81408140 as char) as char(1)))
8140
select hex(weight_string(cast(0x8140 as char) as char(3)));
hex(weight_string(cast(0x8140 as char) as char(3)))
81402020
select hex(weight_string(cast(0x81408140 as char) as char(3)));
hex(weight_string(cast(0x81408140 as char) as char(3)))
8140814020
select hex(weight_string(cast(0x408140 as char) as char(3)));
hex(weight_string(cast(0x408140 as char) as char(3)))
40814020
select hex(weight_string(cast(0x4081408140 as char) as char(3)));
hex(weight_string(cast(0x4081408140 as char) as char(3)))
4081408140
select hex(weight_string(cast(0x40814081408140 as char) as char(3)));
hex(weight_string(cast(0x40814081408140 as char) as char(3)))
4081408140
select hex(weight_string(cast(0x4040814081408140 as char) as char(3)));
hex(weight_string(cast(0x4040814081408140 as char) as char(3)))
40408140
End of 5.1 tests
