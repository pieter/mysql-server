*** Bug #32413 ***
SET @@storage_engine = 'Falcon';
SELECT @@GLOBAL.falcon_record_memory_max INTO @previous_falcon_record_memory_max;
DROP TABLE IF EXISTS t1;
DROP TABLE IF EXISTS t2;
SET GLOBAL falcon_record_memory_max = 16 * 1024 * 1024;
CREATE TABLE t1 (
a INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
b INT,
c VARCHAR(200),
d VARCHAR(1000),
INDEX (b,c),
INDEX (d)
);
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF'));
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
INSERT INTO t1 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t1;
ERROR HY000: Got error 305 'record memory is exhausted' from Falcon
SET GLOBAL falcon_record_memory_max = 128 * 1024 * 1024;
CREATE TABLE t2 (
a INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
b INT,
c VARCHAR(200),
d VARCHAR(1000),
INDEX (b,c),
INDEX (d)
);
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF'));
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
INSERT INTO t2 SELECT NULL, 12345, SHA('12345'), CONCAT(SHA('12345'), SHA('ABCDEF')) FROM t2;
SELECT count(*) from t1;
count(*)
65536
SELECT count(*) from t2;
count(*)
262144
DROP TABLE t1;
DROP TABLE t2;
SET GLOBAL falcon_record_memory_max = @previous_falcon_record_memory_max;
