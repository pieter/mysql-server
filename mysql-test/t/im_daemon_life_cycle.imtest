###########################################################################
#
# This file contains test for (1.2) test suite.
#
# Consult WL#2789 for more information.
#
###########################################################################

--source include/im_check_os.inc

###########################################################################

# Wait for mysqld1 (guarded instance) to start.

--exec $MYSQL_TEST_DIR/t/wait_for_process.sh $IM_MYSQLD1_PATH_PID 30 started

# Let IM detect that mysqld1 is online. This delay should be longer than
# monitoring interval.

--sleep 3

# Check that start conditions are as expected.

SHOW INSTANCES;

###########################################################################

# Kill the IM main process and check that the IM Angel will restart the main
# process.

--exec $MYSQL_TEST_DIR/t/kill_n_check.sh $IM_PATH_PID restarted 30
