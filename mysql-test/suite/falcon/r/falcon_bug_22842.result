#***  Bug 22842 ***
SET storage_engine = Falcon;
DROP TABLE IF EXISTS t1;
# Establish connection conn1 (user = root)
# Switch to connection default
SET @@autocommit=0;
CREATE TABLE t1 (s1 int, s2 int) engine=falcon;
START TRANSACTION;
INSERT INTO t1 VALUES (1,1);
# Switch to connection conn1
SET @@autocommit = 0;
START TRANSACTION;
INSERT INTO t1 VALUES (1,2);
# Switch to connection default
CREATE UNIQUE INDEX i ON t1 (s1);
ERROR HY000: Can't lock file (errno: 212)
COMMIT;
# Switch to connection conn1
COMMIT;
# Switch to connection default
SELECT * FROM t1;
s1	s2
1	1
1	2
DROP TABLE t1;
